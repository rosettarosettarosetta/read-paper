---
description: https://arxiv.org/pdf/2308.13759.pdf
---

# 💡 SamDSK（sam+Domain-Specific ）

## Abstract

将分割基础模型（即SAM）与领域特定知识（DSK）相结合，可靠地利用未标记图像构建医学图像分割模型。我们还开发了一种基于最优匹配的方法，用于在迭代阶段（2）中结合SAM生成的分割建议和像素级、图像级DSK，以构建未标记图像的注释。

我们的工作开启了医学图像分割半监督学习的新方向：分割基础模型可以作为医学图像分割中高效标记的工具。



## Introduction

可以将领域特定知识与SAM相结合，对未标记图像进行注释。



**对抗训练**

**（**Peiris等人\[17]在对抗训练框架中添加了多视图分割组件。最近，王等人\[25]提出了在对抗训练中结合解剖学约束（如连通性、凸性和对称性）的方法，用于从未标记图像中学习。罗等人\[15]将一致性准则与对抗训练相结合，进行医学图像分割模型的半监督学习。设计增强分割一致性的损失和网络结构是医学图像分割中广泛使用的半监督学习方法之一。基于伪标签的研究是半监督学习的另一个方向。伪标签技术最初在\[14]中提出，并被广泛应用于医学图像分割的半监督学习中（例如，\[19]）**）**



对于半监督学习的对抗训练通常建立在未标记样本来自于与标记样本相同的分布的假设上。最小最大优化对于提高分割质量的有效性取决于诸如鉴别器的架构、初始模型参数、未标记样本与标记样本之间的分布变化（如果有）。对比学习在表示学习中表现出很好的性能，但其有效性取决于预任务的设计和训练过程。类似地，一致性损失需要确定未标记图像与图像的多个视图之间的一致性的正确符号。不正确或不适当的对比损失和一致性损失的设计可能使学习无效，甚至对分割性能有害。基于伪标签的技术通常是在训练预测模型（如分类模型、分割模型）时利用未标记图像的常用方法。尽管其有效性很高，但如果大部分伪标签是不正确的，使用伪标签来训练模型可能会导致性能下降的风险。



以往的半监督学习工作通常集中在网络训练和架构设计上，而较少尝试构建和扩展（标记的）训练集。



将新兴的SAM与领域特定知识（Domain-Specific Knowledge，DSK）结合起来，用于注释获取和标记集扩展。



**运行逻辑：**

具体而言，假设我们最初提供了一个标记的图像集合给我们的方法。我们使用这些标记图像训练一个初始的医学图像分割模型。然后，我们将训练好的模型应用于未标记图像，并为所有未标记图像获取分割概率图。我们将这些图称为像素级领域特定知识（pixel-level DSK）。我们进一步引入了一种高级的领域特定知识，称为**图像级DSK**，其中包括分割任务的先验知识，例如每个分割类别在图像中可能的感兴趣区域（Regions of Interests，RoIs）数量。对于一个未标记图像，我们执行一个优化过程，通过将由SAM生成的分割建议与像素级DSK进行匹配，并受到图像级DSK的约束，构建其分割注释。通过上述匹配过程获取分割注释的未标记图像根据最优匹配分数进行检查，那些具有高匹配分数的图像（带有构建的注释）将被添加到标记集中，作为下一轮分割模型训练的机器标记样本。由于更多的标记数据可用，每轮训练中分割模型都会进一步改进，通过多轮的注释获取和模型训练/重新训练，我们期望将具有高质量分割的更多未标记样本添加到标记集中，从而获得更好的医学图像分割模型。

<figure><img src="../../../../.gitbook/assets/image (30).png" alt=""><figcaption></figcaption></figure>

为了更有效地利用SAM，Ma等人\[16]提出使用标记图像对SAM进行微调。Wu等人\[26]提出添加额外的层来适应医学图像分割任务的SAM。我们的工作旨在利用SAM进行医学图像分割模型的半监督学习。





## 2 Related Work&#x20;

### 2.1 Pseudo-labels

尽管**概率图**并不完全被视为标签或伪标签，但通常将这些图称为“软”伪标签。因此，在这里我们回顾了在医学图像分割中使用伪标签进行半监督学习的方法

（概率图（Probability maps）是指在图像分割任务中，对于每个像素或每个图像区域，生成的表示其属于不同类别的概率值的图像。对于像素级别的图像分割，概率图为每个像素提供了属于不同类别的概率分布。概率图可以被视为对每个像素或区域的预测结果的置信度度量，它描述了模型对每个位置或区域属于每个类别的相对可能性。）



### 2.2 SAM for Medical Image Segmentation

为了更有效地利用SAM，Ma等人提出使用带标签的图像对SAM进行微调\[16]。Wu等人提出在SAM上添加额外的层以适应医学图像分割任务\[26]。我们的工作旨在利用SAM进行医学图像分割模型的半监督学习。



### 2.3 SAM和伪标签&#x20;

最近，Chen等人提出使用SAM来改进弱监督学习中的伪标签。SAM在三个地方被应用：（1）改进由CAM生成的注意力图，（2）改进后处理生成的分割结果，和（3）改进由分割模型（DeepLab）生成的分割结果。在本文中，我们利用概率图作为像素级的DSK，用于选择由SAM生成的分割提案。为了使选择更可靠，我们在选择过程中进一步使用了图像级的DSK（例如感兴趣区域的潜在数量），以约束优化过程，以实现将SAM与领域特定知识（在像素级和图像级）相结合的思想。



## 3 Methodology

我们的SamDSK模型的输入由四个部分组成：一个带标签的图像集合D = {(x1, y1)，(x2, y2)，...，(xn, yn)}，一个未标记的图像集合U = {u1，u2，...，um}，Segment Anything Model（SAM）和一个医学图像分割模型M。

医学图像分割模型M的编码器使用ImageNet \[9]预训练的权重进行初始化，解码器随机初始化。

在3.2、3.3和3.4节中，我们描述了生成未标记图像注释的关键步骤（步骤3）。在3.5节中，我们介绍了使用人工标记和机器标记图像进行分割模型训练的过程。在3.6节中，我们分析了我们提出的多轮SSL方法的动态特性。最后，在3.7节中，我们讨论了SamDSK适用于的几个医学图像分割任务。

<figure><img src="../../../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

### 3.1 Applying SAM to Unlabeled Medical Images

我们将最先进的SAM应用于这些图像，以获得每个图像的分割提案。



一个关键考虑因素是在SAM中使用相对较低的阈值设置，以确保生成的分割提案中包含所有潜在的感兴趣区域（RoIs）。默认情况下，当使用SAM时，我们使用以下参数值：“crop nms threshold = 0.5，box nms thresh = 0.5，pred iou thresh = 0.5，stability score thresh = 0.5”。



### 3.2 Matching Segmentation Proposals with Pixel-level DSK



<figure><img src="../../../../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>







{% embed url="https://arxiv.org/pdf/2308.13759.pdf" %}
